# 从耦合开始说设计模式

## 设计模式，从耦合开始，到解耦结束
JAVA面向对象软件开发是个很矛盾的过程。为了实现业务需求的功能，我们编写了各种各样互相关联（耦合）的类（相互独立的类没有任何意义，也无法完成任何工作）。可为了使代码的复用性、可扩展性和可维护性更好，我们又同时把类之间的耦合程度降到最低（解耦合）。所以说，我们的设计，因为耦合开始，又想由解耦而结束。

原则说起来很简单，可真的要实施起来却难度很大。类与类之间的交互常常是一种“刚性”需求，要想既保持业务关系，又让类与类之间解耦，确实需要非常多的技巧和经验。幸运的是，对于一个初学者来说，不需要一切从零开始摸索。在长时间软件开发的积累过程中，人们摸索出了一些重要的设计原则与设计模式来满足我们这种矛盾的需求。只要在软件设计过程中遵循这些原则，并使用已有的设计模式，我们就能够开发出高可用、高可维护性和扩展性的程序。

[设计模式六大原则](设计模式六大原则.md)

[23种设计模式](23种设计模式.md)


## 什么是耦合
耦合原意指指两个或两个以上的事物之间通过相互作用而彼此影响以至联合起来的现象。事物之间如果存在互相作用、互相影响的关系，就构成了耦合关系。

软件工程中的耦合则专指对象之间的依赖性。

## 耦合关系的种类

在面向对象的设计模式中，类与类之间主要有以下6种耦合关系：

  1. 依赖（Dependence）

  对于两个相对独立的对象，当一个对象负责构造另一个对象的实例，或者依赖另一个对象的服务时，这两个对象之间主要体现为依赖关系。定义比较晦涩，但在java中的表现还是比较直观：类A当中使用了类B，其中类B是作为类A的方法参数、方法中的局部变量、或者静态方法调用。

  简单来说就是：人与空气的关系，人是单独的类，空气也是单独的类。构造人不需要空气作为成员变量，构造空气也不需要人作为成员变量。但是人的呼吸方法却离不开空气。

  UML中如下表示：

  ![](img/Dependence.gif)

  2. 关联（Association）

  对于两个相对独立的对象，当一个对象的实例与另一个对象的一些特定实例存在固定的对应关系时，这两个对象之间为关联关系。关联关系分为单向关联和双向关联。在java中，单向关联表现为：类A当中是用了类B，其中类B是作为类A的成员变量。双向关联表现为：类A当中使用了类B作为成员变量；同时类B中也使用了类A作为成员变量。关联关系中作为成员变量的类一般会在类中赋值。也就是说，虽然类A中包含了类B作为成员变量，但类B实例化的过程却与A没有关系。

  举例：两个独立的类，父亲类和儿子类。如果要实现父亲送给儿子礼物的功能，就需要将二者关联起来。在父亲类中加入儿子类的成员变量，或者在儿子类中加入父亲类的成员变量。

  UML中如下表示:

  ![](img/Association1.gif)
  ![](img/Association2.gif)


  3. 聚合（Aggregation）

  聚合关系是关联关系的一种，耦合度强于关联，他们的代码表示是相同的，仅仅是语义上有所区别：关联关系的对象间是相互独立的，而聚合关系的对象之间存在包容关系，他们之间是“整体-个体”的相互关系。聚合关系中作为成员变量的类一般使用set()方法赋值。

  举例：有三个类，汽车，房子和人。为了表达汽车和房子是人的所有财产的场景，就需要在类人中包含类汽车和房子，同时要在类人中为成员变量房子和汽车赋值。

  UML中如下表示:

  ![](img/Aggregation.gif)

  4. 组合（Composition）

  相比于聚合，组合是一种耦合度更强的关联关系。存在组合关系的类表示“整体-部分”的关联关系，“整体”负责“部分”的声明周期，他们之间是共生共死的；并且“部分”单独存在时没有任何意义。

  举例：People与Soul、Body之间是组合关系，当人的声明周期开始时，必须同时有灵魂和肉体；当人的声明周期结束时，灵魂肉体随之消亡；无论灵魂还是肉体，都不能单独存在，他们必须作为人的组成部分存在。

  UML中如下虚线箭头表示:

  ![](img/Composition.gif)

  5. 继承（Generalization）

  继承表示类与类（或者接口与接口）之间的父子关系。在java中，用关键字extends表示继承关系。

  UML中如下实线+空心箭头箭头表示:

  ![](img/Generalization.gif)

  6. 实现（Implementation）

  表示一个类实现一个或多个接口的方法。接口定义好操作的集合，有实现类去完成接口的具体操作。在Java中使用implements表示。

  UML中如下虚线+空心箭表示:

  ![](img/Implementation.gif)

## 对于关系，理解比记忆更重要
对于这些关系的掌握，不要机械记忆，而首先要去理解。结合生活中的场景，或自己在开发过程中的情景去思考和理解。

一个重要的点是，类与类之间的关系，不是想当然的某某关系；它没有固定模式，也非一成不变。具体的关系，是需要我们根据具体需求和要求来设计的。不管是看别人的项目，还是自己写项目，多思考设计层面的东西，都能增进我们对设计的理解。
